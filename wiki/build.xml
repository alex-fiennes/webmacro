<project name="wiki" default="compile" basedir=".">
	<property name="dir.install"   value="/www/wiki" />

	<property name="app.name" value="wiki" />
	<property name="dir.class" value="./class" />
	<property name="dir.src"   value="./src" />
	<property name="dir.lib"   value="./lib" />
        <property name="dir.templates" value="./templates" />
        <property name="dir.etc"       value="./etc" />
	<property name="dir.htdocs"    value="./htdocs" />

	<property name="file.jar"  value="./wiki.jar" />
	<property name="file.resources" value="./wiki-resources.jar" />

	<path id="path.class">
		<fileset dir="${dir.lib}">
			<include name="*.jar" />
			<include name="*.zip" />
		</fileset>
	</path>


	<target name="prepare">
		<mkdir dir="${dir.class}" />
	</target>

	<target name="clean">
		<delete dir="${dir.class}" />
		<delete file="${file.jar}" />
		<delete file="${file.resources}" />
                <delete dir="${dir.install}/deploy" />
	</target>

	<target name="compile" depends="prepare">
		<javac  destdir="${dir.class}"
			debug="on"
			optimize="off"
			deprecation="off"
		>
			<src path="${dir.src}" />
			<classpath refid="path.class" />
		</javac>
	</target>

	<target name="jar" depends="prepare,compile">
		<jar 	jarfile="${file.jar}"
			basedir="${dir.class}"
		/>
	</target>

	<target name="resources">
		<jar	jarfile="${file.resources}"
			basedir="${dir.templates}"
		/>
	</target>

        <target name="install" depends="prepare,compile,jar,resources">
		<mkdir dir="${dir.install}" />
		<mkdir dir="${dir.install}/deploy" />
		<mkdir dir="${dir.install}/deploy/WEB-INF/lib" />
		<copy todir="${dir.install}/deploy">
			<fileset dir="${dir.htdocs}" />
		</copy>
		<copy todir="${dir.install}/deploy/WEB-INF/lib">
			<fileset dir="${dir.lib}" />
			<fileset dir="./" includes="*.jar" />
		</copy>
		<copy todir="${dir.install}/deploy/WEB-INF">
			<fileset dir="${dir.etc}" />
			<filterset>
				<filter token="INSTALL_DIR" value="${dir.install}" />
			</filterset>
		</copy>
	</target>

	<target name="all" depends="clean,prepare,compile,jar,resources,install">

	</target>

</project>
